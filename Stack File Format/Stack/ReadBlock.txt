Sub ReadBlock( blockType as string, blockData as string )
  dim i as integer  dim s as string  dim b as Background  dim c as Card  dim pr as ReportTemplate  select case blockType  case "STAK"    UserLevel=wasc(midb(blockData,&H40+1,2))    i=wasc(midb(blockData,&H44+1,2))    CantModify=(((i\32768) mod 2) = 1)    CantDelete=(((i\16384) mod 2) = 1)    PrivateAccess=(((i\8192) mod 2) = 1)    CantAbort=(((i\2048) mod 2) = 1)    CantPeek=(((i\1024) mod 2) = 1)    Version(0)=hex(lasc(midb(blockData,&H58+1,4)))    Version(1)=hex(lasc(midb(blockData,&H5C+1,4)))    Version(2)=hex(lasc(midb(blockData,&H60+1,4)))    Version(3)=hex(lasc(midb(blockData,&H64+1,4)))    CardHeight=wasc(midb(blockData,&H1B0+1,2))    CardWidth=wasc(midb(blockData,&H1B2+1,2))    if CardHeight=0 then      CardHeight=342    end if    if CardWidth=0 then      CardWidth=512    end if    s=midb(blockData,&H2B8+1,320) //patterns    for i=0 to 39      Patterns(i)=PatternDataToPic(midb(s,i*8+1,8))    next    s=midb(blockData,&H5F8+1) //script    s=leftb(s,instrb(s,chrb(0))-1)    Script=s  case "MAST"      case "LIST"      case "PAGE"      case "BKGD"    b = New Background    b.ReadBKGDBlock blockData    Bg.append b  case "CARD"    c = New Card    c.ReadCARDBlock blockData    Cd.append c  case "BMAP"    if xxPrevBlockType="BKGD" then      Bg(ubound(Bg)).ReadBMAPBlock blockData    elseif xxPrevBlockType="CARD" then      Cd(ubound(Cd)).ReadBMAPBlock blockData    end if  case "STBL"      case "FTBL"    DaFonts.ReadFTBLBlock blockData  case "PRNT"      case "PRST"    PageSetup=midb(blockData,9)  case "PRFT"    pr = New ReportTemplate    pr.ReadPRFTBlock blockData    Reports.append pr  case "HCBG"    for i=0 to ubound(Bg)      if Bg(i).ID=xxResourceId then        Bg(i).ReadHCBGBlock blockData      end if    next  case "HCCD"    for i=0 to ubound(Cd)      if Cd(i).ID=xxResourceId then        Cd(i).ReadHCCDBlock blockData      end if    next  case "ICON"      case "snd "      end select