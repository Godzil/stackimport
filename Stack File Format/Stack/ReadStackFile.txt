Sub ReadStackFile( f as folderItem )
  dim b as BinaryStream  dim r as ResourceFork  dim chunkLength as integer  dim chunkType as string  dim chunkData as string  dim i,m,ii,im as integer  dim r as ResourceFork  DaFonts = new FontTable  DaIcons = new IconTable  DaSounds = new SoundTable  Name=f.Name  b=f.OpenAsBinaryFile(false)  if b<>nil then    b.LittleEndian=false    while not b.eof      chunkLength=b.ReadLong      chunkType=b.Read(4)      chunkData=b.Read(chunkLength-8)      ReadBlock chunkType,chunkData      xxPrevBlockType=chunkType    wend    b.close  end if  r=f.OpenResourceFork  if r<>nil then    m=r.TypeCount    if m>0 then      for i=0 to m-1        chunkType=r.ResourceType(i)        im=r.ResourceCount(chunkType)        if im>0 then          for ii=0 to im-1            xxResourceId=r.ResourceID(chunkType,ii)            xxResourceName=r.ResourceName(chunkType,ii)            chunkData=r.GetResource(chunkType,xxResourceId)            ReadBlock chunkType,chunkData          next        end if      next    end if    r.close  end if  if PrivateAccess then    beep    msgbox "This program cannot open this stack because it has been protected with a password via the PrivateAccess property. Give my regards to the DMCA. :P"    Redim Bg(-1)    Redim Cd(-1)    Redim Reports(-1)    DaFonts=nil    DaIcons=nil    DaSounds=nil    Script=""  end if