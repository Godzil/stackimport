Sub ReadCARDBlock( s as string )
  dim d as string  dim i,x as integer  dim numParts,numContents as integer  dim partLength as integer  dim partData as string  dim p as Part  d=s  ID=wasc(midb(d,&H2+1,2))  i=wasc(midb(d,&HC+1,2))  CantDelete=(((i\16384) mod 2) = 1)  ShowPict=(((i\8192) mod 2) = 0)  DontSearch=(((i\2048) mod 2) = 1)  Owner=wasc(midb(d,&H1E+1,2))  numParts=wasc(midb(d,&H20+1,2))  numContents=wasc(midb(d,&H28+1,2))  d=midb(d,&H2E+1)  if NumParts>0 then    for i=1 to NumParts      partLength=wasc(leftb(d,2))      partData=leftb(d,partLength)      p = new Part      p.ReadPartData partData      Pt.append p      if (partLength mod 2)=1 then        partLength=partLength+1      end if      d=midb(d,partLength+1)    next  end if  if numContents>0 then    for x=1 to numContents      i=wasc(midb(d,&H0+1,2))      partLength=wasc(midb(d,&H2+1,2))      partData=midb(d,&H4+1,partLength)      if i>32767 then //we're reading a card part's contents        i=65536-i        p=GetPartById(i)        if p<>nil then          p.ReadPartContents partData        end if      else //we're reading a bkgnd part's contents        UnsharedTextId.append i        i=wasc(leftb(partData,2))        if i>32767 then          i=i-32768          UnsharedTextContents.append midb(partData,i+1)          UnsharedTextContentsStyleData.append TranslateStyleData(midb(partData,3,i-2))        else          UnsharedTextContents.append midb(partData,2)          UnsharedTextContentsStyleData.append ""        end if      end if      if (partLength mod 2)=1 then        partLength=partLength+1      end if      d=midb(d,partLength+5)    next  end if  'if leftb(d,1)=chrb(0) then  'd=midb(d,2)  'end if  'd=leftb(d,instrb(d,chrb(0))-1)  'Script=d  i=instrb(d,chrb(0))  Name=leftb(d,i-1)  Script=midb(d,i+1)  if rightb(Script,1)=chrb(0) and leftb(Script,1)<>chrb(0) then    Script=leftb(Script,lenb(Script)-1)  end if