Sub ReadBKGDBlock( s as string )
  dim d as string  dim i,x as integer  dim numParts,numContents as integer  dim partLength as integer  dim partData as string  dim p as Part  d=s  ID=wasc(midb(d,&H2+1,2))  i=wasc(midb(d,&HC+1,2))  CantDelete=(((i\16384) mod 2) = 1)  ShowPict=(((i\8192) mod 2) = 0)  DontSearch=(((i\2048) mod 2) = 1)  numParts=wasc(midb(d,&H1C+1,2))  numContents=wasc(midb(d,&H24+1,2))  d=midb(d,&H2A+1)  if NumParts>0 then    for i=1 to NumParts      partLength=wasc(leftb(d,2))      partData=leftb(d,partLength)      p = new Part      p.ReadPartData partData      Pt.append p      if (partLength mod 2)=1 then        partLength=partLength+1      end if      d=midb(d,partLength+1)    next  end if  if numContents>0 then    for x=1 to numContents      i=wasc(midb(d,&H0+1,2))      partLength=wasc(midb(d,&H2+1,2))      partData=midb(d,&H4+1,partLength)      p=GetPartById(i)      if p<>nil then        p.ReadPartContents partData      end if      if (partLength mod 2)=1 then        partLength=partLength+1      end if      d=midb(d,partLength+5)    next  end if  'if leftb(d,1)=chrb(0) then  'd=midb(d,2)  'end if  'd=leftb(d,instrb(d,chrb(0))-1)  'Script=d  i=instrb(d,chrb(0))  Name=leftb(d,i-1)  Script=midb(d,i+1)  if rightb(Script,1)=chrb(0) and leftb(Script,1)<>chrb(0) then    Script=leftb(Script,lenb(Script)-1)  end if